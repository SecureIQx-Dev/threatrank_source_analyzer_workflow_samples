name: secureiqx-threatrank-test

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  vulnerability-scan:
    permissions:
      contents: read
    uses: SecureIQx-Dev/threatrank_source_analyzer/.github/workflows/vulnerability-analyzer.yml@main
    
    with:
      repo_path: "."  # Path to scan, configurable
      cvss_lower_bound: "LOW" # Options: LOW, MEDIUM, HIGH, CRITICAL
      epss_percentile_lower_bound: "0.00"  # Options: 0.00 to 1.00
    
    secrets:
      gemini_api_key: ${{ secrets.GEMINI_API_KEY }} # Not required (strongly recommended)
      pat: ${{ secrets.PAT }} # Required
      license_key: ${{ secrets.LICENSE_KEY }} # Required
